<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Superhond â€” Dashboard</title>

  <!-- Centrale UI (RELATIEF) -->
  <link rel="stylesheet" href="../css/style.css?v=0.20.0" />
  <link rel="stylesheet" href="../css/superhond.css?v=0.20.0" />

  <style>
    /* Tabs */
    .tabs{display:flex;gap:.5rem;margin:1rem 0;flex-wrap:wrap}
    .tab{position:relative;padding:.4rem .8rem;border:1px solid #e5e7eb;border-radius:.5rem;background:#fff;cursor:pointer}
    .tab.active{background:var(--accent,#f4c400);font-weight:600}
    .tab .dot{position:absolute;top:-6px;right:-6px;min-width:18px;height:18px;padding:0 6px;display:inline-flex;align-items:center;justify-content:center;border-radius:999px;font-size:11px;line-height:1;background:#111827;color:#fff}

    .muted{color:#6b7280}
    .error{color:#b91c1c}

    /* Badges op tegels */
    .tile.badged{position:relative}
    .tile .badge-dot{
      position:absolute; top:8px; right:10px;
      min-width:22px; height:22px; padding:0 6px;
      display:inline-flex; align-items:center; justify-content:center;
      border-radius:999px; font-size:12px; line-height:1;
      background:var(--accent,#f4c400); color:#000;
      border:1px solid rgba(0,0,0,.08);
      box-shadow:0 1px 2px rgba(0,0,0,.08);
    }
  </style>
</head>
<body class="dashboard-page">
  <!-- Topbar -->
  <header id="topbar" class="topbar"></header>

  <main class="container">
    <h1 class="page-title">Hoofdmenu</h1>

    <!-- TEGELS -->
    <div class="tiles">
      <a class="tile" href="../klanten/"><span>ğŸ‘¤</span> Klanten</a>
      <a class="tile" href="../honden/"><span>ğŸ¶</span> Honden</a>
      <a class="tile" href="../strippenkaarten/"><span>ğŸ«</span> Strippenkaarten</a>

      <!-- ğŸ“… Lessen (optionele teller; wordt door agenda.js beheerd als je dat zo hebt) -->
      <a class="tile badged" href="../lessen/">
        <span>ğŸ“…</span>
        <div class="tile-body">
          <span class="tile-title">Lessen</span>
          <span class="tile-sub" id="lessen-week-sub">â€”</span>
        </div>
        <span class="badge-dot" id="lessen-week-badge">0</span>
      </a>

      <!-- ğŸ“š Klassen (actief) -->
      <a class="tile badged" href="../klassen/">
        <span>ğŸ“š</span>
        <div class="tile-body">
          <span class="tile-title">Klassen</span>
          <span class="tile-sub" id="klassen-sub">â€”</span>
        </div>
        <span class="badge-dot" id="klassen-badge">0</span>
      </a>

      <!-- ğŸ“¦ Lessenreeksen (actief) -->
      <a class="tile badged" href="../lessenreeks/">
        <span>ğŸ“¦</span>
        <div class="tile-body">
          <span class="tile-title">Lessenreeksen</span>
          <span class="tile-sub" id="reeksen-sub">â€”</span>
        </div>
        <span class="badge-dot" id="reeksen-badge">0</span>
      </a>

      <!-- ğŸ“¢ Mededelingen (optionele teller) -->
      <a class="tile badged" href="../mededeling/">
        <span>ğŸ“¢</span>
        <div class="tile-body">
          <span class="tile-title">Mededelingen</span>
          <span class="tile-sub" id="mededeling-sub">â€”</span>
        </div>
        <span class="badge-dot" id="mededeling-badge">0</span>
      </a>

      <a class="tile" href="../trainers/"><span>ğŸ§‘â€ğŸ«</span> Trainers</a>
      <a class="tile" href="../rapporten/"><span>ğŸ“ˆ</span> Rapporten</a>
      <a class="tile" href="../instellingen/"><span>âš™ï¸</span> Instellingen</a>
      <a class="tile" href="../over/"><span>â„¹ï¸</span> Over</a>

      <!-- âœ… Lessenbeheer (admin) -->
      <a class="tile" href="../lessen/beheer.html"><span>âš™ï¸</span> Lessenbeheer</a>
    </div>

    <!-- AGENDA -->
    <section class="card" style="margin-top:1rem">
      <h2 style="margin:0 0 .5rem">Agenda</h2>

      <div class="tabs" id="agenda-tabs">
        <button class="tab active" data-tab="week">
          Deze week <span class="dot" id="tab-week-dot">0</span>
        </button>
        <button class="tab" data-tab="alles">
          Alles <span class="dot" id="tab-all-dot">0</span>
        </button>
        <button class="tab" data-tab="mededelingen">
          Mededelingen <span class="dot" id="tab-notes-dot">0</span>
        </button>
      </div>

      <div id="agenda-loader" class="muted">â³ Ladenâ€¦</div>
      <div id="agenda-error" class="error" style="display:none"></div>

      <div class="table-wrap" id="agenda-table-wrap" style="display:none;">
        <table id="agenda-table" class="table">
          <thead>
            <tr>
              <th>Naam</th>
              <th>Datum</th>
              <th>Locatie</th>
              <th>Trainer(s)</th>
            </tr>
          </thead>
          <tbody><!-- gevuld door ../js/agenda.js --></tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer id="footer" class="footer"></footer>

  <!-- Scripts -->
  <script src="../js/layout.js?v=0.20.0" defer></script>
  <script src="../js/agenda.js?v=0.20.0" defer></script>

  <!-- Badges voor KLASSEN en REEKSEN (via store.js met status-normalisatie) -->
  <script type="module">
    import { ensureMigrated, getKlassen, getReeksen, isActiefStatus } from '../js/store.js';

    function updateClassAndSeriesBadges(){
      try{
        ensureMigrated();

        const klassens = (getKlassen() || []).filter(k => isActiefStatus(k.status)).length;
        const reeksen  = (getReeksen() || []).filter(r => isActiefStatus(r.status)).length;

        const kc = document.getElementById('klassen-badge');
        const ks = document.getElementById('klassen-sub');
        if (kc) kc.textContent = String(klassens);
        if (ks) ks.textContent = `${klassens} actief`;

        const rc = document.getElementById('reeksen-badge');
        const rs = document.getElementById('reeksen-sub');
        if (rc) rc.textContent = String(reeksen);
        if (rs) rs.textContent = `${reeksen} actief`;
      }catch(e){
        console.error('Badges updaten mislukt:', e);
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      if (window.SuperhondUI?.mount) {
        SuperhondUI.mount({ title: 'Superhond', icon: 'ğŸ¾', home: true });
      }
      updateClassAndSeriesBadges();
    });
  </script>
</body>
</html>
