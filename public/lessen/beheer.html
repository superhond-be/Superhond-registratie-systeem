<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lessenbeheer – Superhond</title>

  <link rel="stylesheet" href="/css/style.css?v=0.20.0" />
  <script>
    /* Gebruik dezelfde key als op de server (.env → AGENDA_API_KEY) */
    window.SH_AGENDA_KEY = "dev-key"; /* <-- vervang in prod */
  </script>
  <script src="/js/layout.js?v=0.20.0" defer></script>
  <script type="module" src="/js/lessen.beheer.js?v=0.20.0" defer></script>
  <style>
    .chips{display:flex;gap:.25rem;flex-wrap:wrap}
    .chip{display:inline-flex;align-items:center;padding:.15rem .5rem;border:1px solid var(--border,#e5e7eb);border-radius:999px}
    .input-time{min-width:7.5ch}
    .hint{color:#6b7280;font-size:.9em}
  </style>
</head>
<body>
<header id="topbar" class="topbar"></header>

<main class="container">
  <h1 class="page-title">Beheer (lessen samenstellen & bewerken)</h1>

  <div class="card" style="margin-bottom:.75rem">
    <div class="toolbar" style="display:flex;gap:.5rem;flex-wrap:wrap;align-items:center">
      <button id="btn-add" class="btn primary">+ Les toevoegen</button>
      <span class="muted" id="total" style="margin-left:.5rem"></span>

      <span style="flex:1 1 auto"></span>

      <button id="btn-export" class="btn">⬇︎ Export lessen.json</button>
      <button id="btn-reeks-gen" class="btn">♻️ Genereer uit reeks</button>
      <label class="btn">⬆︎ Import JSON <input type="file" id="file-import" accept="application/json" hidden></label>
      <a class="btn" href="/">→ Dashboard</a>
    </div>
    <p class="hint" style="margin:.5rem 0 0">Eindtijd berekent automatisch op basis van start + lesduur uit (reeks/pakket). Je kunt eindtijd manueel overschrijven per les.</p>
  </div>

  <div class="table-wrap card">
    <table class="table" id="tbl-lessen">
      <thead>
        <tr>
          <th>Reeks/Naam</th>
          <th>Type</th>
          <th>Locatie</th>
          <th>Thema</th>
          <th>Trainers</th>
          <th>Datum</th>
          <th>Start</th>
          <th>Einde</th>
          <th>Cap.</th>
          <th class="right">Acties</th>
          <th class="right">Genereer</th>
        </tr>
      </thead>
      <tbody><!-- gevuld via JS --></tbody>
    </table>
  </div>
</main>

<footer id="footer" class="footer"></footer>

<!-- Dialoog voor bulk genereren uit reeks -->
<dialog id="dlg-reeks">
  <form id="form-reeks" method="dialog" class="card" style="min-width:min(92vw,560px)">
    <h3 style="margin-top:0">Genereer lessen uit reeks</h3>

    <div class="row">
      <label>Reeks</label>
      <select id="sel-reeks" class="input" required></select>
    </div>

    <div class="row">
      <label>Starttijd (HH:MM)</label>
      <input id="regen-start" class="input input-time" type="time" value="10:00" required>
    </div>

    <div class="row">
      <label><input id="regen-clear" type="checkbox" checked> Bestaande lessen van deze reeks eerst verwijderen</label>
    </div>

    <menu style="display:flex;gap:.5rem;justify-content:flex-end">
      <button type="submit" class="btn primary">Genereer</button>
      <button type="button" id="regen-cancel" class="btn">Annuleren</button>
    </menu>

    <p id="regen-msg" class="muted" style="margin:.5rem 0 0"></p>
  </form>
</dialog>

<script>
  window.addEventListener('DOMContentLoaded', ()=>{
    SuperhondUI.mount({ title:'Superhond — Lessenbeheer', icon:'📅', back:'/' });
  });
</script>
</body>
</html>
