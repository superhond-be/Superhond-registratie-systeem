<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Superhond – Sheets test</title>
  <style>
    body{font:14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin:20px}
    .ok{color:#065f46} .err{color:#b91c1c}
    .card{border:1px solid #e5e7eb; border-radius:8px; padding:12px; margin:10px 0}
    pre{background:#f9fafb; border:1px solid #e5e7eb; padding:8px; border-radius:6px; overflow:auto}
    .muted{color:#6b7280}
  </style>
  <!-- Zet hier je eigen /exec URL -->
  <script>
    window.SUPERHOND_SHEETS_URL =
      "https://script.google.com/macros/s/AKfycbw6LieWdIM9B3ldTSnnJjCRkL33iI-Y7mloRUKWTcCr_puCb7k7_7369O6s6EljrbXMjA/exec";
  </script>
</head>
<body>
  <h1>Sheets koppeling – quick test</h1>
  <p class="muted">Ververs met <kbd>⌘/Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>R</kbd> om de cache te omzeilen.</p>

  <div id="out"></div>

  <script type="module">
    import { fetchSheet, clearCache, getBaseUrl } from './js/sheets.js';

    const TARGETS = ['Klanten','Honden','Klassen','Lessenreeksen','Lessen'];
    const out = document.getElementById('out');

    async function testOne(name){
      const box = document.createElement('div');
      box.className = 'card';
      box.innerHTML = `<h3>${name}</h3><div class="muted">Laden…</div>`;
      out.appendChild(box);

      try{
        const rows = await fetchSheet(name);
        const sample = rows.slice(0,3);
        box.innerHTML =
          `<h3>${name}</h3>
           <p class="ok">✅ OK – ${rows.length} rij(en)</p>
           <details><summary>Voorbeeld (eerste 3)</summary>
             <pre>${JSON.stringify(sample, null, 2)}</pre>
           </details>`;
      }catch(e){
        box.innerHTML =
          `<h3>${name}</h3>
           <p class="err">❌ Fout: ${e.message || e}</p>`;
      }
    }

    // Optioneel: 1x cache wissen bij openen (handig bij testen)
    clearCache();

    const base = getBaseUrl();
    const head = document.createElement('div');
    head.className = 'card';
    head.innerHTML = `<strong>Base URL:</strong> ${base ? base : '<span class="err">NIET ingesteld</span>'}`;
    out.appendChild(head);

    for (const s of TARGETS) testOne(s);
  </script>
</body>
</html>
